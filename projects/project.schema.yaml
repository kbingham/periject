---

## See https://pykwalify.readthedocs.io/en/unstable/validation-rules.html

schema;gitcommit:
  desc: SHA1 in the form \b[0-9a-f]{12,40}\b.*
  type: str
  pattern: \b[0-9a-f]{12,40}\b.*

schema;uuid:
  desc: Unique key defining items and relationship links.
        Generated by the application 'uuid'
  type: str
  pattern: \b[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}\b


###
### Our main schema
###

type: map
mapping:
  title:
    type: str
    required: True

  team:
    type: str
    required: True
    enum: ['Core', 'IO', 'MM']

  assignee:
    type: str
    required: True

  key:
    include: uuid
    required: True

  status:
    type: str
    required: True
    enum: ['New', 'Active', 'Blocked', 'Paused', 'Done', 'Abandoned']

# Optional Fields
  assigneee:
    type: str

  bsp-commits:
    desc: A sequence / list of related BSP commits
          https://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git/commit/?id=
    sequence:
    - include: gitcommit

  upstream-commits:
    desc: References to upstream commits
    sequence:
    - mapping:
        torvalds:
          desc: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=
          sequence:
          - include: gitcommit
        linux-next:
          desc: https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/commit/?id=
          sequence:
          - include: gitcommit

  parent:
    desc: A reference to another topic key which must already exist
    include: uuid

  dependencies:
    sequence:
    - include: uuid
      unique: True

  target-date:
    type: date

  comments:
    sequence:
    - type: str
